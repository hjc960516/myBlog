---
outline: deep

prev:
  text: "threejs入门"
  link: "/threejs/01入门"
next:
  text: "blender模型"
  link: "/threejs/03blender模型"
---

## 自定义模型(线条-贴图-第三方模型)

由于`threejs`没有提供`线条`模型，所以我们需要自己自定义模型, `模型`和`贴图`是在 [polyhaven](https://polyhaven.com/) 上找的

## 线条模型(线条和三角形)

```ts
import * as THREE from "three";
import { OrbitControls } from "three/examples/jsm/controls/OrbitControls.js";

const body = document.body;
const dom = document.querySelector("#canvas") as HTMLCanvasElement;
const width = (dom.width = body.clientWidth);
const height = (dom.height = body.clientHeight);

// 添加场景
const scene = new THREE.Scene();

// ------------- 线条 -------------
const lineGeometry = new THREE.BufferGeometry();
// 定制点位
// 通常有三个模式:
// Vector2: x y, 2d
// Vector3: x y z, 3d
// Vector4: x y z w, 4d, w:齐次坐标系，一般是 平移、旋转、缩放、投影
const positions: THREE.Vector3[] = [
  new THREE.Vector3(0, 0, 0), // 起点
  new THREE.Vector3(100, 0, 0),
  new THREE.Vector3(100, 100, 0),
  new THREE.Vector3(0, 100, 0), // 终点
];
// 将点位设置到几何体中
lineGeometry.setFromPoints(positions);
// 创建材质
const material = new THREE.LineBasicMaterial({
  color: 0xff0000,
  linewidth: 10,
});

// 创建线网格(line网格)
const line = new THREE.Line(lineGeometry, material);
// 将线条添加到场景
scene.add(line);

// -------------- 三角形 -------------------
const triangleGeometry = new THREE.BufferGeometry();
// 将position属性设置到几何体上, threejs会通过position属性来绘制几何体，32位浮点数，3个为一组
triangleGeometry.setAttribute(
  "position",
  new THREE.BufferAttribute(
    new Float32Array([
      -50,
      0,
      0, // 第一个点
      -50,
      -100,
      0, // 第二个点
      0,
      -50,
      0, // 第三个点
    ]),
    3
  )
); // 3 也是 xyz 的意思
// 创建材质
const triangleMaterial = new THREE.LineBasicMaterial({
  color: 0x00ff00,
  linecap: "round", // 圆角
  linejoin: "round", // 圆角
  linewidth: 10,
});

// 创建线网格
// Line：两端的，不会闭合
// LineLoop: 自动闭合，起点和终点会自动闭合
const triangleLine = new THREE.LineLoop(triangleGeometry, triangleMaterial);

// 将线条添加到场景
scene.add(triangleLine);

// 添加相机
const camera = new THREE.PerspectiveCamera(100, width / height);
// 添加相机位置
camera.position.set(100, 100, 100);
// 将相机视角向物体
camera.lookAt(line.position); // 线条位置
// 将相机添加到场景中
scene.add(camera);

// 添加渲染器
const render = new THREE.WebGLRenderer({
  canvas: dom,
});
// 设置渲染器大小
render.setSize(width, height);

// 添加控制器
const controls = new OrbitControls(camera, render.domElement);

// 渲染
const animate = () => {
  requestAnimationFrame(animate); // 代替计时器，RAF 稳定60帧
  render.render(scene, camera); // 将场景和相机添加到渲染器中
  controls.update(); // 更新控制器
};

animate();
```

## 贴图

```ts
import * as THREE from "three";
import { OrbitControls } from "three/examples/jsm/controls/OrbitControls.js";

const body = document.body;
const dom = document.querySelector("#canvas") as HTMLCanvasElement;
const width = (dom.width = body.clientWidth);
const height = (dom.height = body.clientHeight);

// 添加场景
const scene = new THREE.Scene();

// 创建几何体
const geometry = new THREE.BoxGeometry(100, 100, 100);

// 加载贴图
const textureLoader = new THREE.TextureLoader();
// 只支持 jpg png 格式
const texture = textureLoader.load(
  "./assets/textures/textures/raw_plank_wall_diff_1k.jpg"
);
const texture1 = textureLoader.load(
  "./assets/textures/textures/raw_plank_wall_disp_1k.png"
);
// 创建材质
// 通过map属性设置贴图
const material = new THREE.MeshBasicMaterial({
  // color: 0xff0000,
  map: texture,
});
// 也可以设置多面不同的, 只需要将数组传进去即可
const materials = [
  new THREE.MeshBasicMaterial({
    // color: 0xff0000,
    map: texture,
  }),
  new THREE.MeshBasicMaterial({
    // color: 0xff0000,
    map: texture1,
  }),
  new THREE.MeshBasicMaterial({
    // color: 0xff0000,
    map: texture,
  }),
  new THREE.MeshBasicMaterial({
    // color: 0xff0000,
    map: texture1,
  }),
  new THREE.MeshBasicMaterial({
    // color: 0xff0000,
    map: texture,
  }),
  new THREE.MeshBasicMaterial({
    // color: 0xff0000,
    map: texture1,
  }),
];

// 创建网格
// 全部设置统一
// const mesh = new THREE.Mesh(geometry, material)
// 设置不同面
const mesh = new THREE.Mesh(geometry, materials);

// 将网格添加到场景中
scene.add(mesh);

// 添加相机
const camera = new THREE.PerspectiveCamera(70, width / height);
// 添加相机位置
camera.position.set(100, 100, 100);
// 将相机视角向物体
camera.lookAt(mesh.position); // 线条位置
// 将相机添加到场景中
scene.add(camera);

// 添加渲染器
const render = new THREE.WebGLRenderer({
  canvas: dom,
});
// 设置渲染器大小
render.setSize(width, height);

// 添加控制器
const controls = new OrbitControls(camera, render.domElement);

// 渲染
const animate = () => {
  requestAnimationFrame(animate); // 代替计时器，RAF 稳定60帧
  render.render(scene, camera); // 将场景和相机添加到渲染器中
  controls.update(); // 更新控制器
};

animate();
```

## 加载模型

`模型`一般有几种格式，`gltf`、`obj`、`blend`等等,
我下载的模型格式是`gltf`, 将下载的所有东西放在所需位置

```ts
import * as THREE from "three";
import { OrbitControls } from "three/examples/jsm/controls/OrbitControls.js";
// 导入模型加载
import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";
// import { GLTFLoader } from "three/examples/jsm/Addons.js";

const body = document.body;
const dom = document.querySelector("#canvas") as HTMLCanvasElement;
const width = (dom.width = body.clientWidth);
const height = (dom.height = body.clientHeight);

// 添加场景
const scene = new THREE.Scene();

// 加载模型
const loader = new GLTFLoader();
loader.load("./assets/models/sofa_03_4k.gltf", (gltf) => {
  // 将模型放大
  gltf.scene.scale.set(100, 100, 100); // 放大100倍
  // 将加载的模型的场景添加到当前场景中
  scene.add(gltf.scene);
});

// 添加光线
const light = new THREE.DirectionalLight(0xffffff, 1);
// 设置灯光位置
light.position.set(100, 100, 100);
// 将光线添加到场景中
scene.add(light);

// 添加相机
const camera = new THREE.PerspectiveCamera(100, width / height);
// 添加相机位置
camera.position.set(0, 100, 100);
// 将相机视角向物体
// camera.lookAt(scene.position)
// 将相机添加到场景中
scene.add(camera);

// 添加渲染器
const render = new THREE.WebGLRenderer({
  canvas: dom,
});
// 设置渲染器大小
render.setSize(width, height);

// 添加控制器
const controls = new OrbitControls(camera, render.domElement);

// 渲染
const animate = () => {
  requestAnimationFrame(animate); // 代替计时器，RAF 稳定60帧
  render.render(scene, camera); // 将场景和相机添加到渲染器中
  controls.update(); // 更新控制器
};

animate();
```

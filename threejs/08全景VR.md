---
outline: deep

prev:
  text: "模型公路流线和电梯上色"
  link: "/threejs/07模型公路流线和电梯上色"
next:
  text: "mysql浅了解"
  link: "/mysql"
---

## 全景 VR

实际原理是在场景的六个面贴图

```js
import * as THREE from "three";
import { OrbitControls } from "three/examples/jsm/controls/OrbitControls.js";

// 创建场景
const scene = new THREE.Scene();

// 创建相机
const camera = new THREE.PerspectiveCamera(
  45,
  window.innerWidth / window.innerHeight,
  0.1,
  800
);
// 相机位置
camera.position.set(0, 0, 5);
// 相机添加到场景
scene.add(camera);

// 加载vr全景, 图片顺序按照: 右 左 上 下 前 后
const images = [
  "./imgs/home.right.jpg",
  "./imgs/home.left.jpg",
  "./imgs/home.top.jpg",
  "./imgs/home.bottom.jpg",
  "./imgs/home.front.jpg",
  "./imgs/home.back.jpg",
];
// 创建纹理数组, CubeTextureLoader: 专门处理六个面的
const cubeLoader = new THREE.CubeTextureLoader();
const textureArray = cubeLoader.load(images);
// 设置纹理数组的映射方式为CubeReflectionMapping, 用于处理六个面的纹理
textureArray.mapping = THREE.CubeReflectionMapping;
// 将纹理贴到场景的背景
scene.background = textureArray;

// 创建渲染器
const renderer = new THREE.WebGLRenderer({
  antialias: true, // 抗锯齿
});
// 设置渲染器的大小
renderer.setSize(window.innerWidth, window.innerHeight);
// 设置渲染器自适应像素
renderer.setPixelRatio(window.devicePixelRatio);
// 将渲染器的dom元素添加到body中
document.body.appendChild(renderer.domElement);

// 创建控制器
const controls = new OrbitControls(camera, renderer.domElement);

// 交互, 如果需要点击某个点，然后进入某处地方，这个需要特殊的图片的格式
document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowRight") {
    camera.position.x += 0.1;
  }
  if (e.key === "ArrowLeft") {
    camera.position.x -= 0.1;
  }
  if (e.key === "ArrowUp") {
    camera.position.y += 0.1;
  }
  if (e.key === "ArrowDown") {
    camera.position.y -= 0.1;
  }
  if (e.key === "r") {
    camera.position.set(0, 0, 0.1);
    camera.rotation.set(0, 0, 0);
    controls.reset();
  }
});

/**
 * 轮询动画函数
 */
const animate = () => {
  controls.update();
  renderer.render(scene, camera);
  requestAnimationFrame(animate);
};
animate();
```

## 装饰器实现 get 请求

### 初始化

```sh
tsc --init
npm init
# 安装axios
npm i axios -S
```

### 代码

```ts
const axios = require("axios");

// 封装get装饰器
/**
 * GET请求装饰器
 * 接收别的参数时，可以通过柯里化函数来接收
 * @param url 请求地址
 * @returns MethodDecorator 方法装饰器
 */
const GET = (url: string): MethodDecorator => {
  return (
    target: any,
    key: string | symbol,
    descriptor: PropertyDescriptor
  ) => {
    // 获取请求回调
    const fn = descriptor.value;
    console.log(fn);
    axios
      .get(url)
      .then((res: any) => {
        // 将返回结果回传给回调
        fn(res, {
          status: 200,
          msg: "请求成功",
        });
      })
      .catch((err: any) => {
        fn(err, {
          status: 500,
          msg: "请求成功",
        });
      });
  };
};

// 控制器
class Controller {
  constructor() {}
  @GET("https://api.apiopen.top/api/getHaoKanVideo?page=1&size=10")
  getList(res: any, status: any) {
    console.log(res.data, status);
  }
}
```

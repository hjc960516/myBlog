## 项目配置和环境变量

在`nuxt`中，配置项目和环境变量有两种方法:

1. 配置文件`nuxt.config.ts`
2. 单独文件配置

## 配置文件`nuxt.config.ts`

### 项目配置

使用`app`字段进行配置

```ts
// https://nuxt.com/docs/api/configuration/nuxt-config
export default defineNuxtConfig({
  // 开启ssr，默认是开启的
  ssr: true,
  // 限定发布nuxt版本的时间
  compatibilityDate: "2024-11-01",
  // 是否开启调试工具
  devtools: { enabled: true },
  // 配置项目
  app: {
    head: {
      title: "my project", // 页面标题
      charset: "utf-8", // 字符编码
      viewport: "width=device-width, initial-scale=1", // 视口设置
      meta: [
        // 元数据
        { name: "description", content: "my project" },
      ],
      link: [
        // 链接
        { rel: "icon", type: "image/x-icon", href: "/favicon.ico" },
      ],
    },
  },
});
```

### 环境变量配置

使用`runtimeConfig`字段进行配置, 使用`useRuntimeConfig()`主动获取和使用, 如果需要`双端`共享,需要添加`public`字段进行暴露

```ts
// https://nuxt.com/docs/api/configuration/nuxt-config
export default defineNuxtConfig({
  // 开启ssr，默认是开启的
  ssr: true,
  // 限定发布nuxt版本的时间
  compatibilityDate: "2024-11-01",
  // 是否开启调试工具
  devtools: { enabled: true },
  // 配置运行时的公共变量
  runtimeConfig: {
    serverUrl: "xxxx", // 该变量只能在服务端使用
    // pbblic 下的变量可以在客户端和服务端使用
    // process.env.NUXT_PUBLIC_API_BASE 是环境变量文件env中的变量
    public: {
      apiBase: process.env.NUXT_PUBLIC_API_BASE || "/api", // 代理基础路径
    },
  },
});
```

## 单独文件配置

### 项目配置

使用`app.config.ts`进行项目配置, 需要使用`useAppConfig()`主动获取和使用, `server`和`client`都可以使用

1. 创建`app.config.ts`文件

```ts
export default defineAppConfig({
  title: "My App",
});
```

2. 使用

```ts
const { title } = useAppConfig();
console.log(title);
```

### 环境变量配置

使用`useRuntimeConfig()`主动获取和使用,使用`.env`文件进行配置, 开头必须使用`NUXT_xxx_xxx`,使用`大写`

1. 创建`.env`文件
   ,只能在`server`端使用，如果是`相同的key`,`.env`文件会覆盖`nuxt.config.ts`文件中的变量

```ts
TEST_API=123
NUXT_BASE_URL=/ssss
```

2. 关联`nuxt.config.ts`文件

```ts
// https://nuxt.com/docs/api/configuration/nuxt-config
export default defineNuxtConfig({
  // 开启ssr，默认是开启的
  ssr: true,
  // 限定发布nuxt版本的时间
  compatibilityDate: "2024-11-01",
  // 是否开启调试工具
  devtools: { enabled: true },
  // 配置运行时的公共变量
  runtimeConfig: {
    // 如果在.env中有定义会覆盖
    baseUrl: "333",
    // 没有定义可以引用
    testUrl: process.env.TEST_API,
    public: {
      apiBase: process.env.NUXT_PUBLIC_API_BASE || "/api", // 代理基础路径
    },
  },
});
```

3. 使用

```ts
// 获取 .env 或者 nuxt.config.ts 中的环境变量
const config = useRuntimeConfig();
console.log(config);
```

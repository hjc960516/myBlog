## modules

提供可复用或扩展的功能，例如：`pinia`、`elemnt-plus`等等

## 优点

- 简化流程
- 流程一致性
- 生态支持
- 可复用
- ...

## 查询可用 modules

可以在[nuxtmodules 官网](https://nuxt.com/modules)或者`启动项目的工具中的modules中安装查询`

## 导入前端模块

先`下载模块`，然后在`nuxt.config.ts`中添加`modules`属性

### 安装

```sh
# 或者可以使用 自带的工具直接安装
npm i @vant/nuxt
```

### 配置导入

```ts
// https://nuxt.com/docs/api/configuration/nuxt-config
export default defineNuxtConfig({
  // 开启ssr，默认是开启的
  ssr: true,
  // 限定发布nuxt版本的时间
  compatibilityDate: "2024-11-01",
  // 是否开启调试工具
  devtools: { enabled: true },
  // 导入依赖
  modules: ["@vant/nuxt"],
});
```

### 使用

和前端使用方法一样

```vue
<template>
  <van-button>van-button</van-button>
</template>
```

## 导入后端模块

同样的，需要先安装目标模块，然后在`nuxt.config.ts`中添加`modules`属性,
由于在`官方modules库`中没查询到可连接`sql`的`orm`或者`mysql2`模块，为了`简化流程`,所以这里的例子使用`mongodb`进行测试

### 使用 docker 启动

```sh
#  初始化用户和密码, 不设置也可以
#  -e MONGO_INITDB_ROOT_USERNAME=admin \
#  -e MONGO_INITDB_ROOT_PASSWORD=123456 \
# 挂载数据卷
#  -v mongo-data:/data/db \
docker run -d \
  --name mongodb \
  -p 27017:27017 \
  -v mongo-data:/data/db \
  mongo:latest
```

### 安装

```sh
npm install nuxt-mongoose -D
```

### 配置导入

```ts
export default defineNuxtConfig({
  // 开启ssr，默认是开启的
  ssr: true,
  // 限定发布nuxt版本的时间
  compatibilityDate: "2024-11-01",
  // 是否开启调试工具
  devtools: { enabled: true },
  // 导入依赖
  modules: ["@vant/nuxt", "nuxt-mongoose"],
  mongoose: {
    // mongodb://账号:密码@127.0.0.1:27017/数据库名称
    // 或者使用 MONGODB_URI 环境变量, 会自动替换, 需要去掉uri属性
    uri: "mongodb://127.0.0.1:27017/nuxt-mongoose", // 连接地址
  },
});
```

### 创建模型

如果`nuxt.config.ts`中的`mongoose`属性中没有`modelsDir`属性，那么默认会在`server/models`目录下创建模型

```ts
import { defineMongooseModel } from "#nuxt/mongoose";

export interface User {
  name: string;
  age: number;
  sex: 1 | 0;
  email?: string;
}
export const userSchema = defineMongooseModel<User>(
  "User",
  {
    name: {
      type: String,
      required: true,
      unique: true,
    },
    age: {
      type: Number,
      required: true,
    },
    sex: {
      type: Number,
      required: true,
      default: 1,
    },
  },
  {
    timestamps: true, // 自动添加时间戳
  }
);
```

### 使用

在`server/api/mongodb/index.ts`创建

```ts
export default defineEventHandler(async (event) => {
  const users = await userSchema.find({});
  return {
    code: 200,
    message: "get请求成功",
    data: users,
  };
});
```

### 测试

访问 `http://localhost:3000/api/mongodb`进行测试
